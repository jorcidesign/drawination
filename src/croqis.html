<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Croquispop</title>
  <link rel="stylesheet" type="text/css" href="assets/styles.css">
  <!--[if lt IE 11]>
    <link rel="stylesheet" type="text/css"
          href="./input-range-polyfill/input-range-polyfill.css">
    <![endif]-->
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/earlyaccess/nanumgothic.css">
  <script src="js/hand.minified-1.3.6.js"></script>

</head>

<body unselectable="on">

  <br>
  

  <div id="brush-image-shelf">
    <img src="assets/pencil.png" class="brush-image"></img>
    <img src="assets/brushHard.png" class="brush-image"></img>

    <div class="brush-image on" id="circle-brush"></div>
  </div>
  <hr>
  <button type="button" id="clear-button">erase all</button>
  <br>
  <div class="cursor cursor--large"></div>
<div class="cursor cursor--small"></div>
  <div id="canvas-area">
  </div>
  <div id="right-side">
    <div id="color-picker">
      <!-- <div id="color-picker-sb">
        </div> -->
      <span>hue: </span>
      <input id="color-picker-hue-slider" type="range" min="0" max="360">
      <br>
      <span>opacity: </span>
      <input id="brush-opacity-slider" type="range" min="0" max="100">
      <br>
      <span>color: </span>
      <div id="color-picker-checker">
        <p id="color-picker-color"></p>
      </div>
    </div>
    <hr>
    <div id="brush-shelf">
      <span>eraser: </span>
      <input id="select-eraser-checkbox" type="checkbox">
      <hr>
      <span>Brush size: </span>
      <input id="brush-size-slider" type="range" min="1" max="100">
      <br>
      <span>flow: </span>
      <input id="brush-flow-slider" type="range" min="0" max="100">
      <br>
      <span>spacing: </span>
      <input id="brush-spacing-slider" type="range" min="0" max="1000">
      <br>
      <span>angle: </span>
      <input id="brush-angle-slider" type="range" min="0" max="360">
      <br>
      <span>rotate to direction: </span>
      <input id="brush-rotate-to-direction-checkbox" type="checkbox">
    </div>

    <!-- <button type="button" id="fill-button">fill layer</button> -->
  </div>

  <!--[if lt IE 11]>
    <script src="./input-range-polyfill/input-range-polyfill.js"></script>
    <![endif]-->
  <script src="js/tinycolor.js"></script>
  <script src="js/HSBRect.js"></script>
  <script src="js/croquis.js"></script>
  <script src="js/croquispop.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.1.1/gsap.min.js"></script>

  <!-- mejorar este script para la conveniencia del negocio -->
  <script>
   console.clear();

const { gsap } = window;

const cursorOuter = document.querySelector(".cursor--large");
const cursorInner = document.querySelector(".cursor--small");
let isStuck = false;
let mouse = {
	x: -100,
	y: -100,
};

// Just in case you need to scroll
let scrollHeight = 0;
window.addEventListener('scroll', function(e) {
	scrollHeight = window.scrollY
})

let cursorOuterOriginalState = {
	width: cursorOuter.getBoundingClientRect().width,
	height: cursorOuter.getBoundingClientRect().height,
};
const buttons = document.querySelectorAll("main button");

buttons.forEach((button) => {
	button.addEventListener("pointerenter", handleMouseEnter);
	button.addEventListener("pointerleave", handleMouseLeave);
});

document.body.addEventListener("pointermove", updateCursorPosition);
document.body.addEventListener("pointerdown", () => {
	gsap.to(cursorInner, 0.15, {
		scale: 1.5,
	});
});
document.body.addEventListener("pointerup", () => {
	gsap.to(cursorInner, 0.15, {
		scale: 1,
	});
});

function updateCursorPosition(e) {
	mouse.x = e.pageX;
	mouse.y = e.pageY;
}

function updateCursor() {
	gsap.set(cursorInner, {
		x: mouse.x,
		y: mouse.y,
	});

	if (!isStuck) {
		gsap.to(cursorOuter, {
			duration: 0.15,
			x: mouse.x - cursorOuterOriginalState.width/2,
			y: mouse.y - cursorOuterOriginalState.height/2,
		});
	}

	requestAnimationFrame(updateCursor);
}

updateCursor();

function handleMouseEnter(e) {
	isStuck = true;
	const targetBox = e.currentTarget.getBoundingClientRect();
	gsap.to(cursorOuter, 0.2, {
		x: targetBox.left, 
		y: targetBox.top + scrollHeight,
		width: targetBox.width,
		height: targetBox.width,
		borderRadius: 0,
		backgroundColor: "rgba(255, 255, 255, 0.1)",
	});
}

function handleMouseLeave(e) {
	isStuck = false;
	gsap.to(cursorOuter, 0.2, {
		width: cursorOuterOriginalState.width,
		height: cursorOuterOriginalState.width,
		borderRadius: "50%",
		backgroundColor: "transparent",
	});
}

  </script>
  <!--[if lt IE 10]>
    <script>
      // code from: http://stackoverflow.com/a/4448965/1711246
      function makeUnselectable(node) {
        if (node.nodeType == 1) {
          node.setAttribute('unselectable', 'on');
        }
        var child = node.firstChild;
        while (child) {
          makeUnselectable(child);
          child = child.nextSibling;
        }
      }
      makeUnselectable(document.body);
    </script>
    <![endif]-->
</body>

</html>